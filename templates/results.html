{% extends 'base.html' %}
{% block content %}
<div class="animate__fadeInUp">
    <div class="text-center mb-4">
        <i class="fas fa-check-circle text-success" style="font-size: 4rem;"></i>
        <h1 class="mt-3 mb-2" style="font-family: 'Cormorant Garamond', serif; font-size: 2.5rem;">Document Generated Successfully!</h1>
        <p class="text-muted" style="font-size: 1.1rem;">Your document has been created and is ready for download.</p>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card" style="background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(255,255,255,0.1);">
                <div class="card-header" style="background: rgba(15, 23, 42, 0.8); border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <h5 class="mb-0">Document Details</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <p><strong>Template:</strong> {{ document.template.name }}</p>
                            <p><strong>Type:</strong> 
                                <span class="badge" style="background: linear-gradient(45deg, #6dd5ed, #2a8bf2);">
                                    {{ document.template.type|capitalize }}
                                </span>
                            </p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Created For:</strong> {{ document.user_name.replace('_', ' ')|title }}</p>
                            <p><strong>Generated At:</strong> {{ document.created_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
                        </div>
                    </div>

                    <div class="row g-3">
                        <div class="col-md-6">
                            <button onclick="window.location.href='{{ url_for('download_docx', doc_id=document.id) }}'" 
                                    class="btn btn-lg w-100" 
                                    style="padding: 1rem; background: linear-gradient(45deg, #6dd5ed, #2a8bf2); color: white; border: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease;"
                                    onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 25px rgba(109, 213, 237, 0.3)'"
                                    onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none'">
                                <i class="fas fa-file-word"></i> Download DOCX
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button onclick="downloadPDF({{ document.id }})" 
                                    class="btn btn-lg w-100" 
                                    style="padding: 1rem; background: linear-gradient(45deg, #f43f5e, #dc2626); color: white; border: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease;"
                                    onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 25px rgba(244, 63, 94, 0.3)'"
                                    onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none'">
                                <i class="fas fa-file-pdf"></i> Download PDF
                            </button>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-4">
                            <a href="/" class="btn btn-secondary w-100" 
                               style="padding: 1rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.15);">
                                <i class="fas fa-home"></i> Back to Home
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/batch" class="btn btn-success w-100" 
                               style="padding: 1rem; background: linear-gradient(45deg, #22c55e, #16a34a); border: none;">
                                <i class="fas fa-layer-group"></i> Batch Generate
                            </a>
                        </div>
                        <div class="col-md-4">
                            <button onclick="window.location.href='{{ url_for('create', template_id=document.template_id) }}'" class="btn btn-warning w-100" 
                                    style="padding: 1rem; background: linear-gradient(45deg, #f59e0b, #d97706); border: none;">
                                <i class="fas fa-plus"></i> Create Another
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function downloadPDF(docId) {
    const btn = event.target.closest('button');
    const originalText = btn.innerHTML;
    
    // Show loading state
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Converting to PDF...';
    
    // Create a temporary link to trigger download
    window.location.href = `/download-pdf/${docId}`;
    
    // Reset button after a delay (whether successful or not)
    setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = originalText;
    }, 3000);
}
</script>
{% endblock %}